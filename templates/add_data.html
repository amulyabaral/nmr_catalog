add_data.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Data Point</title>
    <style>
        .form-group { margin-bottom: 1rem; }
        label { display: block; margin-bottom: 0.5rem; }
    </style>
</head>
<body>
    <h1>Add New Data Point</h1>
    <a href="{{ url_for('index') }}">Back to Home</a>
    <hr>
    
    <form method="POST">
        <div class="form-group">
            <label for="data_source_id">Data Source ID:</label>
            <input type="text" id="data_source_id" name="data_source_id" required>
        </div>

        <div class="form-group">
            <label for="data_type">Data Type:</label>
            <select id="data_type" name="data_type" required>
                {% for category, subcategories in vocabularies.data_types.items() %}
                    <optgroup label="{{ category }}">
                        {% for subcategory, details in subcategories.items() %}
                            {% if details.formats is defined %}
                                <option value="{{ category }} - {{ subcategory }}">
                                    {{ category }} - {{ subcategory }}
                                </option>
                            {% endif %}
                            {% if details.specific is defined %}
                                {% for specific_type in details.specific %}
                                    <option value="{{ category }} - {{ subcategory }} - {{ specific_type }}">
                                        {{ category }} - {{ subcategory }} - {{ specific_type }}
                                    </option>
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </optgroup>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="data_resolution">Data Resolution:</label>
            <select id="data_resolution" name="data_resolution" required>
                {% for resolution in vocabularies.resolutions %}
                    <option value="{{ resolution }}">{{ resolution }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="repository">Repository:</label>
            <select id="repository" name="repository" required>
                {% for repo in vocabularies.repositories %}
                    <option value="{{ repo }}">{{ repo }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="repository_url">Repository URL:</label>
            <input type="url" id="repository_url" name="repository_url" required>
        </div>

        <div class="form-group">
            <label for="data_description">Description:</label>
            <textarea id="data_description" name="data_description" rows="4" required></textarea>
        </div>

        <div class="form-group">
            <label for="keywords">Keywords (comma-separated):</label>
            <input type="text" id="keywords" name="keywords" required>
        </div>

        <div class="form-group">
            <label for="last_updated">Last Updated:</label>
            <input type="date" id="last_updated" name="last_updated" required>
        </div>

        <div class="form-group">
            <label for="contact_information">Contact Information:</label>
            <input type="text" id="contact_information" name="contact_information" required>
        </div>

        <!-- Additional metadata fields -->
        <fieldset>
            <legend>Additional Metadata</legend>
            {% for key in vocabularies.metadata_keys %}
            <div class="form-group">
                <label for="{{ key }}">{{ key|title }}:</label>
                <input type="text" id="{{ key }}" name="{{ key }}">
            </div>
            {% endfor %}
        </fieldset>

        <div class="form-group">
            <label for="data_format">Data Format:</label>
            <input type="text" id="data_format" name="data_format" required>
        </div>

        <button type="submit">Add Data Point</button>
    </form>

    <script>
    const dataTypes = {{ vocabularies.data_types|tojson|safe }};
    const commonFormats = {{ vocabularies.common_formats|tojson|safe }};

    document.getElementById('data_type').addEventListener('change', function(e) {
        const parts = e.target.value.split(' - ');
        const category = parts[0];
        const subcategory = parts[1];
        const formatInput = document.getElementById('data_format');
        
        let formats = [];
        if (dataTypes[category] && 
            dataTypes[category][subcategory] && 
            dataTypes[category][subcategory].formats) {
            formats = dataTypes[category][subcategory].formats;
        }
        
        // Add suggestion list for formats
        const datalist = document.createElement('datalist');
        datalist.id = 'format-suggestions';
        datalist.innerHTML = formats.map(format => `<option value="${format}">`).join('');
        
        // Update the input
        formatInput.setAttribute('list', 'format-suggestions');
        document.body.appendChild(datalist);
    });
    </script>
</body>
</html>